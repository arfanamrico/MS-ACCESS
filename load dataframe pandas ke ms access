import os
import pandas as pd
import pyodbc

dirpath = r"D:\Dokumen\DUMP\DUMP 3ID 20221017\DUMP 2G SMT\BTS.csv"
data = pd.read_csv(dirpath)
dfbts = pd.DataFrame(data)
dfbts[['PLMN','BSC','BCF','BTS']] = dfbts['DISTNAME'].str.split('/', expand=True)
dfbts['BSCId'] = dfbts['BSC'].str.split('-').str.get(1)
dfbts['BCFId'] = dfbts['BCF'].str.split('-').str.get(1)
dfbts['BTSId'] = dfbts['BTS'].str.split('-').str.get(1)
dfbts['template_name'] = 	dfbts['template_set'] = 	dfbts['siteId'] = 	dfbts['siteCId'] = 	dfbts['applyRepeatedFacch'] = 	dfbts['beamHoppingThreshold'] = 	dfbts['carrierUnitConfiguration'] = 	dfbts['enableTemporaryOverpower'] = 	dfbts['extendedPagingEnabled'] = 	dfbts['facchBusyThreshold'] = 	dfbts['fastReturnToTdScdma'] = 	dfbts['idrCellType'] = 	dfbts['idrUsed'] = 	dfbts['intervalMeasReportSending'] = 	dfbts['oscEdgeMixedUsage'] = 	dfbts['rachBusyThreshold'] = 	dfbts['repeatedFacchInDl'] = 	dfbts['repeatedFacchInUl'] = 	dfbts['repeatedSacchInDl'] = 	dfbts['repeatedSacchInUl'] = 	dfbts['repeatedSacchRxLevThresholdDl'] = 	dfbts['repeatedSacchRxLevThresholdUl'] = 	dfbts['rxSigLevAdjust'] = 	dfbts['sdcchMeasReportSending'] = 	dfbts['tdscdmaNccrEnabled'] = 	dfbts['transportType'] = 	dfbts['txDiversityTimeShift'] = 	dfbts['txSigLevAdjust'] = 	dfbts['cellType'] = 	dfbts['oldDN'] = 	dfbts['siteTemplateDescription'] = 	dfbts['siteTemplateName'] = ''
dfbts['status'] = 'ACTUAL'
dfbts['last_modified'] = dfbts['DATETIME']
dfbts['last_actual_import'] = dfbts['DATETIME']
A_BTS = dfbts[['BSCId',	'BCFId',	'BTSId',	'template_name',	'template_set',	'siteId',	'siteCId',	'adminState',	'allowIMSIAttachDetach',	'amhLowerLoadThreshold',	'amhMaxLoadOfTgtCell',	'amhTrhoGuardTime',	'amhUpperLoadThreshold',	'antennaHopping',	'applyRepeatedFacch',	'bcchTrxPower',	'beamHoppingThreshold',	'bsIdentityCodeBCC',	'bsIdentityCodeNCC',	'bscBscInterfaceStatus',	'btsIsHopping',	'btsLoadInSeg',	'btsLoadThreshold',	'btsMeasAver',	'callReestablishmentAllowed',	'carrierUnitConfiguration',	'cellBarQualify',	'cellBarred',	'cellId',	'cellLoadForChannelSearch',	'cellNumberInBtsHw',	'cellReselectHysteresis',	'cellReselectOffset',	'cellReselectParamInd',	'cnThreshold',	'compositedMultiSiteCell',	'dedicatedGPRScapacity',	'defaultGPRScapacity',	'dfcaMode',	'dfcaUnsyncModeMaList',	'diversityUsed',	'dlNoiseLevel',	'dldcEnabled',	'downgradeGuardTimeHSCSD',	'drInUse',	'drMethod',	'dtmEnabled',	'dtrxPowerDownThreshold',	'dtrxPowerUpThreshold',	'dtxMode',	'eUTRANMultiratReporting',	'eUTRANReportingOffset',	'eUTRANReportingThreshold',	'eUTRANReportingThreshold2',	'earlySendingIndication',	'emergencyCallRestricted',	'enableTemporaryOverpower',	'extendedBcchEnabled',	'extendedPagingEnabled',	'facchBusyThreshold',	'fastReturnToLTE',	'fastReturnToTdScdma',	'fddQMin',	'fddQMinOffset',	'fddQOffset',	'fddRscpMin',	'forcedAmrHrCiThreshold',	'forcedHrCiAverPeriod',	'forcedHrCiThreshold',	'forcedHrModeHysteresis',	'freeTchLimit',	'frequencyBandInUse',	'gsmPriority',	'hcsPriorityClass',	'hcsThreshold',	'hoppingMode',	'hoppingSequenceNumber1',	'hoppingSequenceNumber2',	'hoppingSequenceNumber3',	'ibhoGsmEnabled',	'ibhoWcdmaEnabled',	'idleStateBcchAllocListId',	'idrCellType',	'idrUsed',	'immediateSdcchHoEnabled',	'interferenceAveragingProcessAverPeriod',	'interferenceAveragingProcessBoundary0',	'interferenceAveragingProcessBoundary1',	'interferenceAveragingProcessBoundary2',	'interferenceAveragingProcessBoundary3',	'interferenceAveragingProcessBoundary4',	'interferenceAveragingProcessBoundary5',	'intervalMeasReportSending',	'limForTriggeringOscDfrMultiplexing',	'limForTriggeringOscDhrMultiplexing',	'locationAreaIdLAC',	'locationAreaIdMCC',	'locationAreaIdMNC',	'lowPriorityThr',	'lowerDlRxLevThrForBCCHTrxPref',	'lowerLimitCellLoadHSCSD',	'lteNCCREnabled',	'maioOffset',	'maioStep',	'masterBcf',	'maxGPRSCapacity',	'maxNumberOfRepetition',	'maxNumberRetransmission',	'maxQueueLength',	'maxTimeLimitDirectedRetry',	'measListUsedDuringMeas',	'measurementBCCHAllocation',	'mergedPgsmAndEgsmEnabled',	'minExhaustHSCSD',	'minHSCSDcapacityCell',	'minMsTxPower',	'minTimeLimitDirectedRetry',	'msMaxDistInCallSetup',	'msPriorityUsedInQueueing',	'msTxPwrMaxCCH',	'msTxPwrMaxCCH1x00',	'msTxPwrMaxGSM',	'msTxPwrMaxGSM1x00',	'mscHoCoEn',	'multiBandCell',	'multiBandCellReporting',	'nbrOfSlotsSpreadTrans',	'nbrTchForPrioritySubs',	'newEstabCausesSupport',	'noOfBlocksForAccessGrant',	'noOfMFramesBetweenPaging',	'nobAccessLowerDlRxLevelThreshold',	'nobAccessUpperDlRxLevelThreshold',	'nobDlPowerOffset',	'nobUlPowerOffset',	'nominalDlTxPower',	'nonBCCHLayerOffset',	'notificationOrigin',	'nsei',	'numberOfAdditionalRRHNodes',	'nwName',	'operatorPool',	'oscDfrRemultiplexingEnabled',	'oscDhrRemultiplexingEnabled',	'oscEdgeMixedUsage',	'pathLossOffsetDl',	'pathLossOffsetUl',	'pcuCsHopping',	'pcuCsNonHopping',	'pcuDlBlerCpHopping',	'pcuDlBlerCpNonHop',	'pcuDlLaRiskLevel',	'pcuIdentifier',	'pcuPswTbfDensityTarget',	'pcuPswTbfDowngradeThreshold',	'pcuPswTbfUpgradeThreshold',	'pcuUlBlerCpHopping',	'pcuUlBlerCpNonHop',	'pcuUlLaRiskLevel',	'pcuUpToDate',	'penaltyTime',	'powerOffset',	'precPagingUsage',	'preferBCCHfreqGPRS2',	'priorityChUseIncomingHO',	'prioritySearchThr',	'psei',	'qSearchI',	'qSearchP',	'qSearchPEUTRAN',	'queuePriorityNonUrgentHo',	'queuePriorityUsed',	'queueingPriorityCall',	'queueingPriorityHandover',	'raReselectHysteresis',	'rac',	'rachBusyThreshold',	'rachDropRxLevelThreshold',	'radioLinkTimeout',	'radioLinkTimeoutAmrHrUlIncreaseStep',	'radioLinkTimeoutAmrUlIncreaseStep',	'radioLinkTimeoutUlIncreaseStep',	'radiusExtension',	'repeatedFacchInDl',	'repeatedFacchInUl',	'repeatedSacchInDl',	'repeatedSacchInUl',	'repeatedSacchRxLevThresholdDl',	'repeatedSacchRxLevThresholdUl',	'reselectionAlgorithmHysteresis',	'reservationMethod',	'rxLevAccessMin',	'rxSigLevAdjust',	'scaleOrd',	'sdcchMeasReportSending',	'sectorId',	'segmentId',	'segmentName',	'smsCbUsed',	'stircEnabled',	'superRadiusExtension',	'tdscdmaNccrEnabled',	'temporaryOffset',	'throughputFactor_cs1cs4dlcs',	'throughputFactor_cs1cs4ulcs',	'throughputFactor_mcs1mcs4ulcs',	'throughputFactor_mcs1mcs9dlcs',	'throughputFactor_mcs1mcs9ulcs',	'timeHysteresis',	'timeLimitCall',	'timeLimitHandover',	'timerPeriodicUpdateMs',	'transportType',	'trunkReservationUsed',	'trxPriorityInTchAlloc',	'txDiversityTimeShift',	'txSigLevAdjust',	'ulNoiseLevel',	'underlayHoppingMode',	'underlayMaAllocationId',	'underlayMaioOffset',	'underlayMaioStep',	'upgradeGainHSCSD',	'upgradeGuardTimeHSCSD',	'upperDlRxLevThrForBCCHTrxPref',	'upperLimitCellLoadHSCSD',	'upperLimitRegularLoadHSCSD',	'usedMobileAllocation',	'utranQualRxLevelMargin',	'utranThresholdReselection',	'wcdmaPriority',	'angle',	'cellType',	'insiteGateway',	'name',	'oldDN',	'siteTemplateDescription',	'siteTemplateName',	'status',	'last_modified',	'last_actual_import']]

try:
    con_string = r'DRIVER={Microsoft Access Driver (*.mdb, *.accdb)}; DBQ=D:\Dokumen\DUMP\DUMP 3ID 20221017\DUMP 2G SMT\2GDump.accdb;'
    conn = pyodbc.connect(con_string)
    print('connected to database')
except pyodbc.Error as e:
    print('error in connection', e)

cursor = conn.cursor()
cursor.execute("select * into test from A_BTS")
cursor.commit()
print('table test created')
